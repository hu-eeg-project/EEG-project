#+TITLE: Mens-machine interactie door middel van EEG
#+LANGUAGE: nl-nl
#+OPTIONS: title:nil toc:nil H:4
#+LATEX_HEADER: \pagenumbering{gobble}
#+LATEX_HEADER: \usepackage[margin=3cm]{geometry}
#+LATEX_HEADER: \usepackage{pdfpages}
#+LATEX_HEADER: \usepackage[dutch]{babel}
#+LATEX_HEADER: \setlength{\parindent}{0em}
#+LATEX_HEADER: \usepackage{etoolbox}

#+INCLUDE: title-eindrapport.org

#+LATEX: \newpage
#+LATEX: \pagenumbering{roman}

* Algemene informatie
:PROPERTIES:
:UNNUMBERED: t
:END:
*Opleiding*: Technische Informatica \\
*Organisatie*: Hogeschool Utrecht \\
*Begeleider*: J. Bunk \\
*Document status*: concept \\
*Datum*: \today
\\
*auteur 1:*
- *Naam:* Stefan de Beer
- *Telefoonnummer:* 0611873666
- *E-mail:* stefan.debeer@student.hu.nl
- *Studentennummer:* 1684137
*auteur 2:*
- *Naam:* Paul Ettema
- *Telefoonnummer:* 0630763224
- *E-mail:* paul.ettema@student.hu.nl
- *Studentennummer:* 1677247

#+LATEX: \newpage
#+LATEX: \renewcommand{\contentsname}{Inhoudsopgave}
#+LATEX: \tableofcontents

#+LATEX: \newpage
#+LATEX: \pagenumbering{arabic}

* Begrippen
#+ATTR_LATEX: :environment longtable :align |l|p{10cm}|
|-------------------+---------------------------------------------------------------------|
| Begrip            | Betekenis                                                           |
|-------------------+---------------------------------------------------------------------|
|                   | <67>                                                                |
| ADC               | Analog Digital Converter. Zet een analoge stroom om in een digitale waarde. |
| BCI               | Brein Computer Interface.                                           |
| Channel           | In context met elektrode: een enkele elektrode met daarbij behorende hardware om hersenactiviteit te meten op een plek. In context met ADC: een input van de ADC waarop het de stroom kan omzetten in een digitale waarde. |
| EEG               | Elektro-encefalografie is een methode om hersenactiviteit te meten door de kleine elektrische stromen die de hersenen maken te meten. |
| Elektrode         | Component wat elektronisch contact maakt met het lichaam om stroom van hersenen te meten. |
| Hardwaredeel      | Een categorie van hardwarecomponenten zoals bijvoorbeeld een ADC of Op-Amp. |
| Hardwarecomponent | Meer specifiek dan hardware deel bijvoorbeeld een specifieke chip.  |
| Op-Amp            | Operationele Amplifier. Een chip die een analoog signaal kan versterken. |
| PoC               | Proof of Concept.                                                   |
|-------------------+---------------------------------------------------------------------|
#+LATEX: \newpage
* Inleiding
Volgens de Hype Cycle van Gartner uit 2018 is een Brein-Computer-Interface (BCI) op dit moment bij de "Peak of Inflated Expectation" cite:Gartner_hype. Dit houdt in dat er voor dit onderwerp een aantal succesvolle implementatie zijn gemaakt, maar deze implementaties zijn nog wel erg duur. Hierdoor is het dus een interessant onderwerp om te onderzoek of een BCI ook goedkoop geïmplementeerd kan worden. Daarnaast is het Turing Lab op de Hogeschool Utrecht hierin geïnteresseerd omdat dit een goede kans is om huidige en toekomstige studenten veel aan te kunnen leren over BCI-systemen en programmeren. \\
Tijdens dit onderzoek zal specifiek op EEG-systemen worden gericht wat de hersengolven meet, dit omdat EEG op de basis van BCI ligt. Een EEG werkt door middel van elektrodes die op het hoofd worden geplaatst. Deze electrodus meten de kleine electische stroom die van de hersenen komen, welke daarna door een computer kan worden verwerkt tot een handeling, zoals een robotarm bewegen. \\
Dit onderzoek wordt gedaan door twee studenten van technische Informatica aan de hogeschool Utrecht, voor het onderzoekssemester.
#+CAPTION: De EEG-headset van OpenBCI cite:BCI_headset
#+NAME: fig:bci_headset
#+ATTR_LATEX: :width 250px
#+ATTR_LATEX: :height 250px
[[./images/bci_headset.jpg]]
* TODO
#+LATEX: \newpage

* Theoretisch kader
In dit hoofdstuk wordt het theoretisch kader van dit project beschreven. Als eerste worden er een aantal centrale begrippen over het onderwerp toegelicht. Daarna worden er een aantal belangrijke bronnen neergezet. En als laatste worden gerelateerde werken genoemd.
** Core Concepts
*** Brain Computer Interfacing
Een Brain Computer Interface is een alternatieve manier om een computer te besturen ten opzichte van bijvoorbeeld de veelgebruikte muis en toetsenbord. Bij een Brain Computer Interface wordt de computer door middel van neuronen activiteit in de hersenen bestuurt. Bij deze techniek bestaan er invasive en noninvasive manieren. Bij invasive manieren moet er iets in het lichaam geplaatst worden om de activiteit te meten en bij de noninvasive manier wordt de hersen activiteit van de buitenkant van het lichaam gemeten door bijvoorbeeld gebruik te maken van elektroden cite:vallabhaneni2005brain. Een voorbeeld van een noninvasive-BCI welke gebruik maakt van de elektrodes is de EEG. Een voorbeeld van een invasive-BCI is door zogenoemde "Depth electrodes" in de hersenen te steken. De meeste van deze elektrodes hebben 4 tot en met 12 contact punten die tussen de 5 en 10 mm van elkaar af staan cite:zumsteg2000presurgical.

*** Hersenen regio's
Voor dit onderzoek is het belangrijk om te weten waar in de hersenen wat gebeurd. Dit is omdat dit belangrijke informatie is voor de plaatsing van de elektrodes. Er zijn vier belangrijke regio's in de grote hersenen, namelijk cite:Brain_and_Behavior:
 - Frontale kwab: Dit is de regio aan de voorkant van het brein. Het is verantwoordelijk voor de volgende functies:
  - Aandacht hebben voor dingen of zicht goed kunnen concentreren
  - Het maken van plannen
  - Oplossen van problemen
  - Precieze bewegingen maken van bijvoorbeeld: handen, voeten, tong en het gezicht
  - Hoe een persoon zich gedraagt
  - Reageren op emoties
 - Occipitale kwab: Deze kwab is verantwoordelijk voor het kijken en speelt ook een rol in het herkennen van wat gezien wordt
 - Temporale kwab: Deze regio verantwoordelijk is voor horen, taal, smaken en speelt ook een rol in het herkennen wat gezien wordt
 - Pariëtale kwab: Deze regio is vooral verantwoordelijk voor het voelen, bijvoorbeeld iets aanraken met de vingers
*** Hersengolven
Hans Berger was in 1924 de eerste persoon die de hersengolven van een persoon heeft afgenomen, hiermee is hij ook de persoon die als eerste een EEG-systeem gemaakt heeft cite:Haas2003. Hersengolven zijn sinusoïde golven die gegenereerd worden door de neuronen in de hersenen. Deze golven kunnen gemeten worden aan de buitenkant van de schedel. Hier is de stroom die gemeten wordt wel klein, namelijk 0,5 tot 100 µV cite:EEG_fundamenental.
Hersengolven zijn verdeelt in meerdere categorieën met hun eigen frequenties. Tijdens het zoeken naar deze frequenties is tot de conclusie gekomen dat veel bronnen andere frequenties zeggen.
  Bij dit onderzoek worden de volgende frequenties gebruikt, welke gevonden zijn is een artikel van William O. cite:Extraordinary_EEG:
#+ATTR_LATEX: :environment longtable :align |l|p{4cm}|p{5cm}|p{4cm}|
|--------+-------------------------+-----------------------------------------------------------+--------------------------------------------------------------|
| *Golf* | *Frequentiebereik (Hz)* | *Komt voor tijdens*                                       | *Pathologisch*                                               |
|--------+-------------------------+-----------------------------------------------------------+--------------------------------------------------------------|
| Delta  |                 0,5-3,5 | Slapen, hyperventilatie, baby's, ouderen                  | Hersenaandoeningen, laesie in de witte stof van de hersenen  |
|--------+-------------------------+-----------------------------------------------------------+--------------------------------------------------------------|
| Theta  |                   3,5-8 | Slaperigheid, kinderen, ouderen                           | Hersenaandoeningen, laesie (minder correlatie dan bij Delta) |
|--------+-------------------------+-----------------------------------------------------------+--------------------------------------------------------------|
| Alpha  |                    8-13 | Ontspanning, sluiten van ogen                             | Coma, beroerte                                               |
|--------+-------------------------+-----------------------------------------------------------+--------------------------------------------------------------|
| Beta   |                   13-30 | Ogen open cite:EEG_fundamenental, wakker/actief           | Drugs overdosis                                              |
|--------+-------------------------+-----------------------------------------------------------+--------------------------------------------------------------|
| Gamma  |                   30-80 | Bewegen van spieren, iets leren of het geheugen gebruiken | Beroerte                                                     |
|--------+-------------------------+-----------------------------------------------------------+--------------------------------------------------------------|

Een van de meest bekende hersengolven is de P300-hersengolf. De P300 is een event-related-potetial (ERP) cite:polich07_updat_p300, wat wil zeggen dat het een elektrofysiologische reactie is van de hersennen. De P300 komt voor tussen de 0,5 Hz en de 15 Hz cite:Lafuente2017. De P300 ontstaat wanneer de hersenen een gebeurtenis detecteert welke aandacht trekt, zoals een lichtflits. Daarnaast kent de P300 twee vormen, namelijk de P3a en de P3b. De P3a komt voor als er een gebeurtenis is welke nog nieuwe is voor de hersenen. Als deze gebeurtenis vaker voorkomt zal de P300 golf steeds meer op een P3b gaan lijken waarbij de hersenen meer data uit de het geheugen gaan verwerken dan bij de P3a cite:polich07_updat_p300. Het verschil in uiterlijk tussen de P3a en de P3b is dat de P3a een hogere piek in amplitude heeft dan de P3b. Ook is herkomst uit de hersenen anders, zo onstaat de P3a meer in de frontale kwab en de P3b meer uit de temporale/pariëtale kwab. Omdat de P300 vaak voorkomt en relatief makkelijk te meten is, zal het bij dit onderzoek worden gebruikt als minimale eis aan het EEG-systeem dat wordt gemaakt.

#+CAPTION: p3a en p3b golf cite:EEG_synthesis
#+NAME: fig:P300GOLF
#+ATTR_LATEX: :width 200px
[[./images/p3ab.png]]

*** Signaalmeting
In dit onderzoek wordt met signaalmeting het meten van het signaal bedoeld om deze later te kunnen verwerking. In dit project zal dit worden gebruikt om hersengolven van een persoon te meten. Uit vooronderzoek cite:xu2011160 is gebleken dat voor het meten van hersengolven een elektrode en een analoog-digitaal converter (ADC) nodig is. Echter is nog niet duidelijk wat de precieze eisen zijn aan deze hardwaredelen, daarom zal dit worden onderzocht in dit onderzoek. Hieronder zal elektrode en ADC kort worden uitgelegd:
**** Elektrode
Een elektrode is een analoge sensor die de EEG gebruikt om contact te maken met het hoofd. Doordat elektroden contact maken met het hoofd kunnen hersengolven gemeten worden door de schedel heen. Hierbij is het nodig een goede elektrische verbinding te maken tussen de elektrode en het hoofd om potentiële ruis te verminderen. Voor het verbeteren van dit contact kan een gel gebruikt worden cite:usakli2010improvement. Elektrodes verschillen onder elkaar ook nog op meerdere attributen. Zo zijn ze verkrijgbaar in verschillende maten. Sommige elektrodes zijn herbruikbaar en anderen zijn maar één keer te gebruiken.

#+CAPTION: Elektrode cite:EEG_Elektrode
#+NAME: fig:ELEKTRODE
#+ATTR_LATEX: :width 200px
[[./images/grass_silver_cup_electrodes_single.jpg]]

*Plaatsing* \\
Er zijn standaarden voor de plaatsingen van elektrodes op de schedel cite:Electrode_placement. Een voorbeeld hiervan is het 10-20 systeem, zoals te zien is in figuur [[fig:10-20]]. Bij dit systeem wordt de schedel is vijf verschillende delen verdeeld, deze delen hebben een grote van 10% of 20% van het totaal. In figuur [[fig:10-20-side]] is te zien hoe de verdeling is van deze regio's. In dit figuur is alleen verdeling vanaf de zijkant te zien, maar dezelfde deling geld ook vanaf de voorkant en de bovenkant.\\
Te zien is dat de regio's een naam krijgen zoals "F5", "Cz" of "T4". Hierbij is de eerste letter de hersenregio die de elektrode zal meten, zoals "F" voor Frontale kwab, "T" voor Temporale, "P" voor Pariëtale en "O" voor Occipitale. De tweede letter of cijfer is toegevoegd om verschillende plekken in een regio aan te kunnen geven. De even getallen voor de rechter helft van de schedel en de oneven getallen zijn voor de linker helft. De "z" in bijvoorbeeld "Cz" staat voor zero.
Er zijn ook varianten met een deling van maar 10% of zelfs 5% cite:Oostenveld2001.
#+CAPTION: De vijf verschillende delen cite:Electrode_placement
#+NAME: fig:10-20-side
#+ATTR_LATEX: :width 200px
[[./images/10-20-side.png]]

#+CAPTION: 10-20 systeem cite:10-20-img
#+NAME: fig:10_20_placement
#+LABEL: fig:10-20
#+ATTR_LATEX: :width 200px
[[./images/10-20-sys.png]]

**** Versterking
Omdat de stroom uit de elektrodes zeer klein is zal dit eerst moeten worden versterkt om tot een meetbaar niveau te komen voor de ADC. Voor deze versterking wordt een versterker IC gebruikt welke in het engels ook wel een "amp" wordt genoemd. Er zijn twee soorten versterking IC's, welke hieronder kort worden uitgelegd.

*Operationele versterker*
De Operationele versterker of opamp is een IC die veel gebruikt wordt om signalen te versterken cite:opamp_handbook. Een opamp heeft twee inputs en een output. De twee inputs zijn de inverting- en de non-invertinginputs. De opamp is zo ontworpen dat op de output het voltage verschil van de inputs gezet wordt keer de versterking, wat standaard hoog is (rond de 100000). De output kan echter niet hoger worden dan de voltage van de voeding.

*Instrumentele versterker*
Een ander soort versterker is de instrumentele versterker of inamp. De inamp lijkt sterk op de opamp dat het een verschil tussen de twee inputs keer een versterking op de output zet. Maar een inamp heeft een nog hogere input impedantie waardoor het te meten signaal nog minder wordt verstoord. Ook kan de versterking van een inamp worden gezet door een enkele weerstand, terwijl bij een opamp twee weerstanden nodig zijn cite:inamp_uitleg. 

**** Bemonsteringstheorema van Nyquist-Shannon
Bij het meten van het signaal is het belangrijk dat er met de juiste frequentie gemeten word. het Bemonsteringstheorema van Nyquist-Shannon zegt dat het aantal keren per seconden dat het signaal gemeten wordt (sps) hoger moet zijn dan de frequentie in het signaal cite:Nyquist. Als minder vaak gemeten wordt dan de frequentie in het signaal kan het gemeten signaal foutief zijn. Als de sps gelijk is aan de frequentie dan zal er een constant voltage worden gemeten, zoals te zien in figuur [[fig:nyquist]].
#+CAPTION: Onjuiste en juiste meet frequentie
#+NAME: fig:nyquist
#+LABEL: fig:nyquist
#+ATTR_LATEX: :width 300px
[[./images/n-sample.jpg]]

**** ADC
De ADC vertaalt het analoge signaal vanuit de elektrodes naar een digitaal signaal. Dit is zodat deze op de computer met gebruik van algoritmes kunnen worden verwerkt naar bijvoorbeeld een frequentieanalyse. Met de frequentieanalyse kan dan bijvoorbeeld de P300-hersengolf worden gedetecteerd. Doordat de elektrische stroom uit de hersenen klein is, 0,5 tot 100 µV, zal deze eerst nog versterkt moeten worden tot een waarde die gemeten kan worden door de ADC. De sampling frequentie van de ADC hoeft niet heel snel zijn omdat de frequentie van de hersengolven niet hoog zijn, maximaal 80Hz voor gamma golven.

**** DRL
Voor het tegengaan van noise in het EEG-systeem is een DRL (Driven Right Leg) circuit een goede toevoeging cite:venkatesh_2011. Een DRL werkt op het principe dat bij de instrumentele amplifier het Common-Mode voltage op de versterkingsweerstand staat. Het Common-Mode voltage is de stroom die door het hele lichaam verdeeld is en ontstaat door elektriciteit om het persoon heen, bijvoorbeeld TL buizen of het lichtnet om ons heen. 
Een DRL verlaagd die Common-Mode noise door de Common-Mode van de instrumentele amplifiers te nemen en hier het geïnverteerde signaal terug te leiden naar het persoon. Hierdoor heffen beide stromen elkaar op, echter is dit nooit perfect.
Om de Common-Mode van de instrumentele amplifier te nemen moet het worden gebufferd om geen invloed op de werking van de instrumentele amplifier te hebben. Hiervoor wordt het in een opamp gevoerd, wat als buffer zal dienen, die vervolgens het signaal aan de DRL zelf geeft. De DRL heeft de input van één of meerdere aangesloten op de inverting input van de opamp. De non-inverting input wordt dan op de grond aangesloten om zo de inverse van het signaal te creëren. De output van dit circuit is dan aangesloten aan bijvoorbeeld een earclip om zo de inverse Common-Mode signaal terug te brengen naar de gebruiker van de EEG om de invloed daarvan te verminderen.

*** Signaalverwerking
Signaalverwerking is het analyseren of verwerken van signalen om nuttige operaties op deze signalen uit te voeren. Bij dit project zal het gaan over het verwerken en analyseren van signalen uit de hersenen, oftewel hersengolven. Hierbij zal vooral worden gefocust op het vinden van het P300-signaal uit de hersenen, waarvoor het signaal eerst van ruis moeten worden vrij gemaakt.

**** Signaalruis
Bij een EEG-systeem zijn er verschillende soorten ruis. Voor het meten van het signaal kan dit worden verdeeld in Thermal Noise, Channel Noise, Synaptic Noise en overige. Bij Thermal Noise wat ook bekend is als /Johnson noise/ gaat het om voltage veranderingen door de invloed van temperatuur. Dit kan worden verminderd door de temperatuur of de frequentie te verminderen. Channel Noise wordt veroorzaakt door stochastic ionic channels op de membraan van cellen. Deze channels openen en sluiten toevallig en hebben invloed op het geleiden van stroom. Dit is dus ook een mogelijke bron van ruis. Naast channels die openen en sluiten gaat het bij Synaptic Noise om neurotransmitter moleculen die vrijgelaten worden door cellen. Dit beïnvloed ook de geleiding van stroom waardoor het ruis kan veroorzaken cite:manwani1999detecting. Als laatste zijn er ook nog overige vormen van ruis. Zo kunnen signalen voor spieren van bijvoorbeeld de ogen ruis genereren cite:woestenburg1983removal.

** Belangrijke bronnen
Voor dit onderzoek zijn er een aantal bronnen die belangrijk zijn. Deze zullen hieronder worden beschreven hoe deze relevant zijn en waarom ze betrouwbaar zijn.\\
Onderstaande zijn de bronnen die kunnen worden gebruikt om het juiste algoritme te vinden voor het detecteren van het P300-signaal uit het EEG-signaal. De keywords die gebruikt zijn voor het vinden van deze bronnen zijn: EEG, P300, en Algorithm.
- /A review of classification algorithms for EEG-based brain–computer interfaces: a 10 year update/ cite:lotte18_review_class_algor_eeg_inter: Dit is een artikel uit het "Journal of Neural Engineering". Volgens ResearchGate heeft dit journal heeft een impact factor van 4,84 in 2015. Dit artikel is relevant voor dit onderzoek omdat het verschillende recent gevonden (2007-2017) algoritmes voor het detecteren van features uit het EEG-signaal bespreekt. Ook is dit artikel uit 2017, dus nog recent. In dit artikel worden ook bronnen gegeven naar andere onderzoeken waar deze algoritmes worden voorgesteld, deze kunnen goed van pas komen voor het onderzoek.
- /Adaptive Methods in BCI Research - An Introductory Tutorial/ cite:Schlgl2009: Het eerste artikel beschrijft dat adaptieve classificatie algoritmes goed zijn en geeft dit artikel als referentie hiervoor, daarom is artikel dus ook relevant voor het onderzoek.
- /Updating P300: An integrative theory of P3a and P3b/ cite:polich07_updat_p300 uit "Clinical Neurophysiology". Volgens Elsevier heeft dit journal een impact factor van 3,614. Dit is relevant doordat in dit onderzoek erop ingaat wat het P300 signaal is en hoe deze eruitziet, wat benodigde informatie is voor het detecteren van een P300-signaal.
- /P300 brainwave extraction from EEG signals: An unsupervised approach/ cite:Lafuente2017: Dit artikel legt uit wat het P300 signaal is en hoe deze kan worden gedetecteerd, dit is dus ook weer relevant voor het onderzoek naar P300. Dit is een artikel uit het journal "Expert Systems with Applications". Dit journal heeft volgens Elsevier een impact factor van 3,7. Het artikel komt 2017, wat dus nog recent is.

Hier onder volgt een bron die kan worden gebruikt voor het onderzoeken naar de benodigde hardware:
- /A 160 \textmu{}W 8-Channel Active Electrode System for EEG Monitoring/ cite:xu2011160 uit "IEEE TRANSACTIONS ON BIOMEDICAL CIRCUITS AND SYSTEMS". Volgens IEEE heeft dit journal een impact factor van 3,5. Dit is relevant want hier gaat het om de hardware setup van een EEG om signalen te meten, wat nodig is voor de eerste deelvraag. Ook komt deze bron uit 2011 wat het nog redelijk recent maakt.
** Gerelateerde werk
Hieronder volgen bronnen die gerelateerd zijn aan dit onderzoek:
- Bergen, H. (1929, 2 april). Uber das Elektrenkephalogramm des Menschen. Geraadpleegd op 21 september 2018, van http://pubman.mpdl.mpg.de/pubman/item/escidoc:2281721:3/component/escidoc:2281720/Berger_1929_Ueber_Elektroenkephalogramm.pdf \\
  Dit is het eerste onderzoek naar EEG-metingen op de mens van Hans Berger.
- Bang, J. W., Choi, J. S., & Park, K. R. (2013). Noise reduction in brainwaves by using both EEG signals and frontal viewing camera images. Sensors, 13(5), 6272-6294.\\
  Bij dit onderzoek gebruiken ze een EEG in combinatie met een camera voor een P300-speller.
- Abootaleb, V., Moradi, M. H., & Khalilzadeh, M. A. (2009, april). A new approach for EEG feature extraction in P300-based lie detection. Geraadpleegd op 28 september 2018, van https://linkinghub.elsevier.com/retrieve/pii/S0169260708002484\\
  Hier wordt het P300-signaal gebruikt om leugens te detecteren.
#+LATEX: \newpage


* Benodigde hardware EEG
In dit hoofdstuk zal de resultaten worden weergegeven uit het literatuuronderzoek naar de hardwaredelen en componenten die nodig zijn om een EEG-systeem te maken. Als eerste zal worden beschreven welke hardware delen nodig zijn en daarna zal worden beschreven welke componenten binnen deze delen kunnen worden gebruikt.

** Benodigde hardwaredelen
In het hoofdstuk over signaalmeting is al verteld dan uit vooronderzoek is gebleken dat tenminste een elektrode en een ADC benodigd is om een EEG-systeem te maken. Echter zal met alleen deze twee hardwaredelen geen succesvol EEG-systeem kunnen worden gemaakt. Dit hoofdstuk zal beschrijven welke hardware delen nog meer nodig zijn. De informatie voor het onderzoeken hiernaar is verkregen door literatuurstudie te doen naar andere EEG-systemen. Enkele van deze systemen zijn opensource waardoor goed te zien is hoe het bij deze systemen gedaan is.\\

Een van deze opensource EEG-systemen is genaamd OpenEEG. OpenEEG is een project met als doel om goedkope EEG-systemen en de software hiervoor te maken cite:OpenEEG. Via de webshop Olimex zijn twee PCB's te koop van OpenEEG, de ene is een versterker genaamd modEEGamp en de andere bevat een ADC en een microcontroller om de gemeten data te kunnen versturen naar een computer.
Als naar de schematics van de modEEGamp gekeken wordt, welke te vinden is in [[Bijlage A: schakelschema modEEGamp][Bijlage A]] is goed te zien welke hardware delen gebruikt zijn.
Te zien is dat er per kanaal twee versterkers worden gebruikt, waarvan de ene een instrumentale versterker (inamp) is en de andere een operationele versterker(opamp). voorafgaand aan de inamp is een protectiecircuit tegen......

In [[Bijlage B: schakelschema versterker][Bijlage B]] is nog een schakelschema te zien welke waarin ook een inamp en een opamp gebruikt wordt om de hersensignalen te versterken. Echter is dit schema niet het protectiecircuit en de filtering tegen rf-signalen te zien. Dit schema is eerder gebruikt in een succesvol onderzoek naar het maken van een EEG-systeem cite:Diy_EEG. Hieruit kan dus worden afgeleid dat het protectiecircuit en de filtering tegen rf-signalen niet perse nodig, maar misschien wel beter prestaties levert. Of dit nodig is zal moeten worden getest.

Dankzij de bestudeerde bronnen is de volgende lijst van benodigde onderdelen opgesteld:
- *Elektrode*: om signalen uit de hersenen van een persoon te meten moet contact worden gemaakt met de hoofdhuid, hiervoor worden elektrodes gebruikt.
- *Instrumentele versterker (inamp)*: een inamp wordt gebruikt om het verschil tussen de elektrode op het oor en een andere elektrode als uitput te krijgen en deze ook de versterken.
- *Operationele versterker (opamp)*: een opamp wordt gebruikt om de output uit de inamp voor het grootste gedeelte te versterken tot een voltagebereik wat kan worden gemeten door een analoog-digitaal converter.
- *Signaalfiltering*: verwacht wordt dat er in het signaal veel ruis zal bevinden en dat signaalfilter nodig zijn, zoals een lowpas filter die alles boven de 50Hz van het lichtnet verwijderd. Hiervoor kan een opamp worden gebruikt, maar ook weerstand in combinatie met een condensator. Ook kan de ruisfiltering in de comuter worden gedaan.
- *Analoog-digitaal converter (ADC)*: om het analoge signaal uit de opamp om te zetten naar een digitaal signaal is een ADC nodig. De ADC moet tenminste 160 metingen per seconden op acht kannalen kunnen doen. Er is hier voor 160 gekozen omdat de maximale frequentie die moet kunnen worden gemeten 80Hz is, wat de maximale frequentie van gammagolven uit de hersenen is. Dit dubbele is nodig om aan Nyquist-frequentie te voldoen. !!! NOG EEN EIS OVER RESOLTIE!!!!
- *Microcontroller*: de microcontroller zal de data uit de ADC uitlezen en doorsturen naar een computer. De enige eisen aan de microcontroller zijn dat het USB verbinding kan hebben met een computer zodat de data kan worden verstuurd. Als er gekozen wordt om de ADC van een microcontroller te gebruiken zullen de eisen van de ADC bij die van de microcontroller komen.

** De hardware componenten
Nu er een globaal beeld is van wat er nodig is om een EEG-systeem te maken moeten er nog specifiek hardware componenten worden bepaald. Dit wordt gedaan in dit hoofdstuk.
In [[Benodigde hardwaredelen]] zijn er een aantal eisen gesteld waar de componenten aan moeten voldoen. Aan het einde van dit hoofdstuk wordt er een lijst opgesteld met de verschillende hardwarecomponenten die nodig zijn voor het EEG-systeem. Voor elke hardwaredeel zal er een tabel worden gemaakt waarin meerdere componenten in dit deel worden vergeleken om zo tot een selectie te komen van componenten. De selectie wordt dan in het echt getest om te kijken welke beter is.

Als eerste zal worden bepaald welke elektrodes worden gebruikt. Hieronder is een tabel te zien van de elektrodes welke worden vergeleken.
Gekozen is om beide de EEG-AE en de EEG-PE te bestellen en daarnaast ook nog one-time-use elektrodes te kopen met een Silver Chlorided Plastic coating. Voor de EEG-AE en de EEG-PE is gekozen om het verschil tussen een actieve en passive elektrode te kunnen meten, ook zijn deze elektrodes niet one-time-use. Voor de one-time-use elektrodes is gekozen om te meten hoe deze vergelijken met de andere twee elektrodes en ook om te kijken hoe goed deze elektrodes werken als deze vaker worden gebruikt dan een keer.
Er is niet voor de andere elektrodes gekozen omdat deze of te duur zijn(>30 euro) of minder makkelijker leverbaar zijn in Nederland. \\

Bij het kiezen van een instrumentele versterker(inamp) is het belangrijk dat deze zo ruisvrij mogelijk is. Daarnaast is het ook handig als de inamp een DIP-package (of through hole) is, dit omdat het dan makkelijker is om iets aan de pinnen van de inamp vast te maken of te solderen. Ook kan, als het nodig is, de inamp dan in een breadboard worden gestoken om het testen makkelijker te maken.\\

#+BEGIN_COMMENT
Als naar de vergelijkingstabel voor de instrumentele versterker gekeken wordt, dan is te zien dat de AD8429 de beste prestaties levert kwa ruis. Echter zullen wij niet kiezen voor deze chip omdat deze niet als DIP-package beschikbaar is, maar is er voor de INA129P en de AD620ARZ gekozen. Voor de AD620ARZ is gekozen omdat deze veel gebruikt wordt in bestaande EEG-schakelschema's, zoals die van de OpenEEG of schakelschema's uit meerdere papers cite:Sahin2015,Badillo.
Daarnaast is gekozen voor de INA129P omdat deze goedkoper is dan de andere. Dit zodat een goedkopere inamp kan worden vergeleken met een duurdere.
#+END_COMMENT

Voor instrumente amplifiers (inamp) is het belangrijk dat er weinig noise is. Dit komt doordat het de eerste chip is waar het signaal van een elektrode binnenkomt waar de kleinste ruis het meeste verschil uitmaakt. Bij de inamp is er gekozen om de AD620ANZ en INA129P te gebruiken. Hiervoor is gekozen omdat er niet veel verschil tussen de input noise zit van de verschillende inamps in de lijst. Ook zijn deze inamps verkrijgbaar als DIP-package wat het solderen makkelijker maakt. Deze twee zijn ook vaker gebruikt in andere zelfgemaakte EEG systemen, zoals OpenEEG.

Voor de opamp hebben we gekozen om de standaard veelgebruikte en goedkope LM358 te testen en een duurdere OP27GPZ. De OP27GPZ is een opamp gespecialiseerd op low noise en is ook vaker in andere EEG schakelschema's tegen gekomen. Hieruit is besloten om deze twee met elkaar te vergelijken of het een significant verschil maakt om een gespecialiseerde opamp te gebruiken op het gebied van ruis.

#+LATEX: \newpage
* Bronnen
#+LATEX: \patchcmd{\thebibliography}{\section*{\refname}}{}{}{}
bibliographystyle:apalike
bibliography:sources.bib
#+LATEX: \newpage
* Bijlage
** Bijlage A: schakelschema modEEGamp
:PROPERTIES:
:CUSTOM_ID: BijlageA
:END:
Hieronder kan het schakelschema voor de modEEGamp worden gevonden. Dit schema is gedownload vanaf de volgende link: https://www.olimex.com/Products/EEG/OpenEEG/EEG-ANALOG-ASM/resources/modEEGamp_v1.1.pdf
#+LATEX_ATTR:
[[./images/modEEGamp_v1.1.png]]
#+LATEX: \newpage

** Bijlage B: schakelschema versterker
:PROPERTIES:
:CUSTOM_ID: BijlageB
:END:
Hieronder kan een schakelschema worden gevonden voor de versterking van de hersensignalen uit de elektrodes. Dit schema is gedownload vanaf de volgende link: https://sites.google.com/site/chipstein/_/rsrc/1257001084516/home-page/eeg-with-an-arduino/assembling-the-arduino-eeg-circult/Arduino%20PreampNG.jpg?height=327&width=420

#+CAPTION: Versterker schema voor EEG cite:chipstein
[[./images/Arduino_PreampNG.jpg]]
#+LATEX: \newpage

** Bijlage C: Vergelijkingstabellen voor benodigde hardware

#+ATTR_LATEX: :environment longtable :align |p{3cm}|p{1,2cm}|p{2cm}|p{2cm}|p{2cm}|p{2cm}|p{2cm}|
|----------------------------------------------------------+-------+---------+--------------+-------------------------------+------------------+-----------------------------|
| Naam                                                     | Stuks | Prijs   | Herbruikbaar | Materiaal in contact met huid | Diameter van pad | Extra                       |
|----------------------------------------------------------+-------+---------+--------------+-------------------------------+------------------+-----------------------------|
| Biomedical Sensor Pad                                    |    10 | €9,62   | nee          | ?                             | 24 mm            | Al voorbereid met gel       |
|----------------------------------------------------------+-------+---------+--------------+-------------------------------+------------------+-----------------------------|
| Genuine Grass Reusable 10mm Silver Cup Surface Electrode |    10 | $179,95 | ja           | zilver                        | 10 mm            |                             |
|----------------------------------------------------------+-------+---------+--------------+-------------------------------+------------------+-----------------------------|
| Technomed Silver Cup EEG Electrodes                      |    12 | $125,-  | ja           | zilver                        | 10 mm            |                             |
|----------------------------------------------------------+-------+---------+--------------+-------------------------------+------------------+-----------------------------|
| IMA Silver EEG Flat Electrode                            |     1 | $16,16  | ja           | zilver                        | 8 mm             |                             |
|----------------------------------------------------------+-------+---------+--------------+-------------------------------+------------------+-----------------------------|
| GS29 Solid Gel - Square Cloth Electrode                  |   600 | $125,99 | nee          | zilver                        | 22 x 22 mm       |                             |
|----------------------------------------------------------+-------+---------+--------------+-------------------------------+------------------+-----------------------------|
| Dry EEG Comb Electrodes                                  |    30 | $29,99  | ja           | zilver chloride coating       | 6,35 mm          | Kan door haar heen meten    |
|----------------------------------------------------------+-------+---------+--------------+-------------------------------+------------------+-----------------------------|
| Disposable EEG Cup Electrode                             |    25 | €27,50  | ja           | zilver chloride coating       | 10 mm            |                             |
|----------------------------------------------------------+-------+---------+--------------+-------------------------------+------------------+-----------------------------|
| EEG-AE                                                   |     1 | €9,00   | ja           | goud                          | ?                | Bevat een signaalversterker |
|----------------------------------------------------------+-------+---------+--------------+-------------------------------+------------------+-----------------------------|
| EEG-PE                                                   |     1 | €5,00   | ja           | goud                          | ?                |                             |
|----------------------------------------------------------+-------+---------+--------------+-------------------------------+------------------+-----------------------------|
| Oorelectrode                                             |     2 | €26.25  | ja           | tin                           | ?                | Oor referentie voor EEG     |
|----------------------------------------------------------+-------+---------+--------------+-------------------------------+------------------+-----------------------------|

#+ATTR_LATEX: :environment longtable :align |p{1,5cm}|p{1cm}|p{1,5cm}|p{1,5cm}|p{1,5cm}|p{2,4cm}|p{1,5cm}|p{1,5cm}|
|-----------------+--------------+----------+-----------------------+----------------------------+------------------------------------------+------------------+---------|
| Naam            | Prijs (Euro) | Precisie | metingen per seconden | input/ output ruis uV(RMS) | signaal-ruisverhouding en distortie (dB) | niet lineariteit | kanalen |
|-----------------+--------------+----------+-----------------------+----------------------------+------------------------------------------+------------------+---------|
| MCP3021         | 0,94         | 10-bit   | 22k                   | ?                          | 60                                       | +/- 0,25 LSB     |       1 |
|-----------------+--------------+----------+-----------------------+----------------------------+------------------------------------------+------------------+---------|
| TLC1543         | 12,95        | 10-bit   | 32k                   | ?                          | ?                                        | +/- 1 LSB        |      11 |
|-----------------+--------------+----------+-----------------------+----------------------------+------------------------------------------+------------------+---------|
| MCP3008         | 3,50         | 10-bit   | 75k-200k              | ?                          | 51                                       | +/- 0,25 LSB     |       8 |
|-----------------+--------------+----------+-----------------------+----------------------------+------------------------------------------+------------------+---------|
| ad7705          | 2,60         | 16-bit   | 38,4K                 | ?/110                      | ?                                        | 0,003%           |       2 |
|-----------------+--------------+----------+-----------------------+----------------------------+------------------------------------------+------------------+---------|
| ads1115         | 2,50         | 16-bit   | 860                   | 32,25                      | ?                                        |                  |       2 |
|-----------------+--------------+----------+-----------------------+----------------------------+------------------------------------------+------------------+---------|
| ESP32 ADC       | 13,99        | 12-bit   | 6K                    | ?                          | ?                                        |                  |     2x8 |
|-----------------+--------------+----------+-----------------------+----------------------------+------------------------------------------+------------------+---------|
| Arduino Uno adc |              | 8-bit    | 9,615K                | ?                          | ?                                        |                  |       8 |
|-----------------+--------------+----------+-----------------------+----------------------------+------------------------------------------+------------------+---------|

 #+ATTR_LATEX: :float sidewaystable :placement [H] :align |p{2cm}|p{1,3cm}|p{1,5cm}|p{1,5cm}|p{1,5cm}|p{2,5cm}|p{1,5cm}|p{2cm}|p{2cm}|p{2cm}|
|-----------+--------------+----------+----------------+-----------------+----------------------+-------------------+----------------------+----------------------+-----------------------------|
| Naam      | Prijs (Euro) | Channels | Max verterking | Min voeding (V) | Voltage noise (uVpp) |              CMRR | Input noise (nV/√Hz) | Input noise (nV/√Hz) | Gain error                  |
|           |              |          |                |                 | g=1000 f=0,1-10Hz    | (tot 60hz G=1000) |               @ 30Hz |               @ 1kHz | G=100/1000                  |
|-----------+--------------+----------+----------------+-----------------+----------------------+-------------------+----------------------+----------------------+-----------------------------|
| INA12PA   | 10,00-11,42  |        1 |          10000 | 2,25            | 0,2                  |               120 |                    8 |                    9 | 0,7%/ 2%                    |
| MCP6N16   | 2,92         |        1 |              ? | 1,8             | 19,0                 |                   |                   30 |                      | 0,03%                       |
| AD620ARZ  | 11,03        |        1 |          10000 | 2,3             | 0,28                 |                   |                      |                    9 | 0,15%/0,14%                 |
| AD8221    | 8,28         |        1 |           1000 | 2,3             | 0,25                 |                   |                      |                    8 | 0,3%/ 0,3%                  |
| AD8429ARZ | 10,49        |        1 |          10000 | 4,0             | 0,1                  |               134 |                      |                    1 | 0,3 voor alles groter dan 1 |
| INA129    | 5,95         |        1 |          10000 | 2,25            | 0,2                  |               130 |                      |                    8 | 0,05%/0,5%                  |
|-----------+--------------+----------+----------------+-----------------+----------------------+-------------------+----------------------+----------------------+-----------------------------|

* aantekeningen cursus

scriptie structuur
- voorblad
- (versiebeheer)
- (voorwoord)
- management samenvatting
- inhoudsopgave
- inleiding
- Aanleiding, context, organisatorische context, kwestie(probleemstelling), opdracht, doel
- theoretisch kader
- vraagstelling
- Methoden
- uitwerking opdracht, resultaten, conclusie en inleiding per resultaat
- conclusie
- aanbevelingen
- bronvermelding
- bijlage
